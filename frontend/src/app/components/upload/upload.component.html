<!-- Header -->
<header>
  <app-navbar></app-navbar>
</header>
<!-- Estado de análisis (pantalla completa mientras se cargan resultados) -->
<div *ngIf="isProcessing" class="analysis-container">
  <h2>Analizando imágenes...</h2>
  <p>Por favor espera mientras procesamos el análisis BI-RADS.</p>
  <p style="font-style: italic; max-width: 600px; text-align: center; margin-top: 0.5rem;">
    Este sistema está diseñado para asistir en la clasificación BI-RADS, 
    pero la decisión clínica final depende del criterio del radiólogo.
  </p>
  <div class="spinner"></div>
</div>
<!-- Formulario de carga -->
<div class="container-centered" *ngIf="!isProcessing">
  <h1>Clasificador de Mamografías en Escala BI-RADS</h1>
  <!-- Subida de vistas específicas con etiquetas -->
  <div class="upload-list mt-3">
    <label class="upload-item">
      <span class="upload-label">L-CC (Cráneo-Caudal Izquierda)</span>
      <input
        type="file"
        (change)="onFilesSelected($event, 'l_cc')"
        accept=".dcm,.dicom,.jpg,.jpeg,.png,.tif,.tiff"
        class="upload-input"
      />
    </label>
    <label class="upload-item">
      <span class="upload-label">R-CC (Cráneo-Caudal Derecha)</span>
      <input
        type="file"
        (change)="onFilesSelected($event, 'r_cc')"
        accept=".dcm,.dicom,.jpg,.jpeg,.png,.tif,.tiff"
        class="upload-input"
      />
    </label>
    <label class="upload-item">
      <span class="upload-label">L-MLO (Oblicua Medio-Lateral Izquierda)</span>
      <input
        type="file"
        (change)="onFilesSelected($event, 'l_mlo')"
        accept=".dcm,.dicom,.jpg,.jpeg,.png,.tif,.tiff"
        class="upload-input"
      />
    </label>
    <label class="upload-item">
      <span class="upload-label">R-MLO (Oblicua Medio-Lateral Derecha)</span>
      <input
        type="file"
        (change)="onFilesSelected($event, 'r_mlo')"
        accept=".dcm,.dicom,.jpg,.jpeg,.png,.tif,.tiff"
        class="upload-input"
      />
    </label>
  </div>
  <!-- Imágenes seleccionadas -->
  <div *ngIf="imagenesKeys.length > 0" class="imagenes-list mt-3">
    <div class="imagen-item" *ngFor="let key of imagenesKeys">
      <span class="imagen-label">{{ key.toUpperCase() }}:</span>
      <span class="imagen-filename">{{ imagenesSeleccionadas[key].name }}</span>
    </div>
  </div>

    <!-- Advertencia -->
  <div class="mensaje-aviso" style="max-width: 600px; margin: 2.5rem auto 0.5rem; font-size: 0.95rem; text-align: center; color: #444;">      
    <p><i>Las imágenes seleccionadas serán procesadas por el sistema para realizar una clasificación automatizada en escala BI-RADS.</i></p>
    <p><i>Recuerde que el resultado es un apoyo diagnóstico y no reemplaza su interpretación clínica como profesional.</i></p>
  </div>

  <!-- Botón de análisis -->
  <button
    (click)="analizarImagenes()"
    [disabled]="imagenesKeys.length === 0"
    class="button-primary mt-3"
    style="margin-top: 0.1rem;"
  >
    Analizar Imágenes
  </button>
</div>
<style>
.analysis-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: white;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-family: 'Helvetica Neue', sans-serif;
  text-align: center;
}
.analysis-container h2 {
  font-size: 28px;
  margin-bottom: 0.5rem;
  font-weight: bold;
}
.analysis-container p {
  font-size: 14px;
  margin-bottom: 2rem;
}
.analysis-container .spinner {
  border: 8px solid #f3f3f3;
  border-top: 8px solid #3498db;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  animation: spin 1s linear infinite;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
